2025-05-21 15:29:38,549 - utils.helpers - INFO - Starting data collection for NIFTY with expiry 22-05-2025
2025-05-21 15:29:38,549 - utils.helpers - INFO - Starting dashboard...
2025-05-21 15:29:38,559 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:29:38,559 - utils.helpers - INFO - Collecting data...
2025-05-21 15:29:38,724 - data_collection.auth - INFO - Authentication successful, token expires in 45021 seconds
2025-05-21 15:29:38,724 - data_collection.collector - INFO - Collecting data for NIFTY with expiry 22-05-2025
2025-05-21 15:29:39,294 - data_collection.collector - INFO - Data saved to data/21-05-2025/NIFTY/NIFTY_22-05-2025_1529.xlsx
2025-05-21 15:29:39,300 - database.db_manager - INFO - Saved 95 records to database
2025-05-21 15:29:39,300 - utils.helpers - INFO - Successfully collected data with 95 rows
2025-05-21 15:29:39,300 - utils.helpers - INFO - Sleeping for 5 minutes until next collection...
2025-05-21 15:29:42,441 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 15:29:42,450 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:29:42,450 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:29:42,450 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:29:42,558 - database.db_manager - WARNING - No user settings found
2025-05-21 15:34:39,308 - utils.helpers - INFO - Outside trading hours. Waiting for next check...
2025-05-21 15:39:04,092 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 15:39:04,106 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:39:04,106 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:39:04,108 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:39:04,117 - database.db_manager - WARNING - No user settings found
2025-05-21 15:39:04,304 - data_collection.auth - INFO - Authentication successful, token expires in 44455 seconds
2025-05-21 15:39:04,305 - data_collection.collector - INFO - Collecting data for NIFTY with expiry 21-05-2025
2025-05-21 15:39:04,465 - data_collection.collector - ERROR - No data to save
2025-05-21 15:39:04,466 - database.db_manager - ERROR - No data to save to database
2025-05-21 15:39:06,558 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 15:39:06,559 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:39:06,560 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:39:06,561 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:39:06,564 - database.db_manager - WARNING - No user settings found
2025-05-21 15:39:12,949 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 15:39:12,950 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:39:12,951 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:39:12,951 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:39:12,954 - database.db_manager - WARNING - No user settings found
2025-05-21 15:39:12,962 - database.db_manager - WARNING - No data found for NIFTY 21-05-2025
2025-05-21 15:39:12,963 - processing.calculator - ERROR - No data available for processing
2025-05-21 15:39:13,990 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 15:39:13,992 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:39:13,993 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:39:13,994 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:39:13,997 - database.db_manager - WARNING - No user settings found
2025-05-21 15:39:14,005 - database.db_manager - WARNING - No data found for NIFTY 21-05-2025
2025-05-21 15:39:14,006 - processing.calculator - ERROR - No data available for processing
2025-05-21 15:39:15,648 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 15:39:15,649 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:39:15,650 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:39:15,650 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:39:15,654 - database.db_manager - WARNING - No user settings found
2025-05-21 15:39:15,662 - database.db_manager - WARNING - No data found for NIFTY 21-05-2025
2025-05-21 15:39:15,663 - processing.calculator - ERROR - No data available for processing
2025-05-21 15:41:24,499 - utils.helpers - INFO - Starting data collection for NIFTY with expiry 22-05-2025
2025-05-21 15:41:24,499 - utils.helpers - INFO - Starting dashboard...
2025-05-21 15:41:24,502 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:41:24,502 - utils.helpers - INFO - Outside trading hours. Waiting for next check...
2025-05-21 15:41:25,494 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 15:41:25,498 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:41:25,498 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:41:25,499 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:41:25,596 - database.db_manager - WARNING - No user settings found
2025-05-21 15:41:30,881 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 15:41:30,883 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:41:30,884 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:41:30,885 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:41:30,887 - database.db_manager - WARNING - No user settings found
2025-05-21 15:41:30,896 - database.db_manager - WARNING - No data found for NIFTY 21-05-2025
2025-05-21 15:41:30,898 - processing.calculator - ERROR - No data available for processing
2025-05-21 15:41:33,292 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 15:41:33,294 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:41:33,296 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:41:33,296 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:41:33,298 - database.db_manager - WARNING - No user settings found
2025-05-21 15:41:33,442 - data_collection.auth - INFO - Authentication successful, token expires in 44306 seconds
2025-05-21 15:41:33,443 - data_collection.collector - INFO - Collecting data for NIFTY with expiry 21-05-2025
2025-05-21 15:41:33,562 - data_collection.collector - ERROR - No data to save
2025-05-21 15:41:33,562 - database.db_manager - ERROR - No data to save to database
2025-05-21 15:41:36,198 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 15:41:36,199 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:41:36,200 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:41:36,200 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:41:36,204 - database.db_manager - WARNING - No user settings found
2025-05-21 15:41:36,212 - database.db_manager - WARNING - No data found for NIFTY 21-05-2025
2025-05-21 15:41:36,213 - processing.calculator - ERROR - No data available for processing
2025-05-21 15:41:42,427 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 15:41:42,429 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:41:42,430 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:41:42,430 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:41:42,434 - database.db_manager - WARNING - No user settings found
2025-05-21 15:41:42,544 - data_collection.auth - INFO - Authentication successful, token expires in 44297 seconds
2025-05-21 15:41:42,545 - data_collection.collector - INFO - Collecting data for NIFTY with expiry 21-05-2025
2025-05-21 15:41:42,658 - data_collection.collector - ERROR - No data to save
2025-05-21 15:41:42,658 - database.db_manager - ERROR - No data to save to database
2025-05-21 15:41:49,002 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 15:41:49,004 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:41:49,006 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:41:49,007 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:41:49,010 - database.db_manager - WARNING - No user settings found
2025-05-21 15:41:49,019 - database.db_manager - WARNING - No data found for NIFTY 21-05-2025
2025-05-21 15:41:49,019 - processing.calculator - ERROR - No data available for processing
2025-05-21 15:41:52,008 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 15:41:52,010 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:41:52,011 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:41:52,012 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:41:52,016 - database.db_manager - WARNING - No user settings found
2025-05-21 15:41:52,024 - database.db_manager - WARNING - No data found for NIFTY 21-05-2025
2025-05-21 15:41:52,025 - processing.calculator - ERROR - No data available for processing
2025-05-21 15:41:54,199 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 15:41:54,201 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:41:54,202 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:41:54,203 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:41:54,206 - database.db_manager - WARNING - No user settings found
2025-05-21 15:41:54,215 - database.db_manager - WARNING - No data found for NIFTY 21-05-2025
2025-05-21 15:41:54,216 - processing.calculator - ERROR - No data available for processing
2025-05-21 15:47:36,097 - utils.helpers - INFO - Starting data collection for NIFTY with expiry 22-05-2025
2025-05-21 15:47:36,097 - utils.helpers - INFO - Starting dashboard...
2025-05-21 15:47:36,100 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:47:36,100 - utils.helpers - INFO - Outside trading hours. Waiting for next check...
2025-05-21 15:47:37,032 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 15:47:37,037 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:47:37,037 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:47:37,037 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:47:37,140 - database.db_manager - WARNING - No user settings found
2025-05-21 15:47:39,690 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 15:47:39,691 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:47:39,694 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:47:39,695 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:47:39,697 - database.db_manager - WARNING - No user settings found
2025-05-21 15:47:39,836 - data_collection.auth - INFO - Authentication successful, token expires in 43940 seconds
2025-05-21 15:47:39,837 - data_collection.collector - INFO - Collecting data for NIFTY with expiry 21-05-2025
2025-05-21 15:47:39,957 - data_collection.collector - ERROR - No data to save
2025-05-21 15:47:39,958 - database.db_manager - ERROR - No data to save to database
2025-05-21 15:47:41,922 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 15:47:41,924 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:47:41,925 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:47:41,926 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:47:41,929 - database.db_manager - WARNING - No user settings found
2025-05-21 15:47:41,937 - database.db_manager - WARNING - No data found for NIFTY 21-05-2025
2025-05-21 15:47:41,938 - processing.calculator - ERROR - No data available for processing
2025-05-21 15:47:51,996 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:47:51,997 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:47:51,997 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:47:51,998 - database.db_manager - WARNING - No user settings found
2025-05-21 15:47:52,042 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 15:48:01,088 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 15:48:01,089 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:48:01,090 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:48:01,090 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:48:01,092 - database.db_manager - WARNING - No user settings found
2025-05-21 15:48:01,153 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 15:48:01,154 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:48:01,155 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:48:01,156 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:48:01,157 - database.db_manager - WARNING - No user settings found
2025-05-21 15:48:01,167 - database.db_manager - WARNING - No data found for NIFTY 21-05-2025
2025-05-21 15:48:01,168 - processing.calculator - ERROR - No data available for processing
2025-05-21 15:48:11,201 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 15:48:11,202 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:48:11,204 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:48:11,204 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:48:11,205 - database.db_manager - WARNING - No user settings found
2025-05-21 15:48:21,284 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 15:48:21,286 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:48:21,287 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:48:21,288 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:48:21,289 - database.db_manager - WARNING - No user settings found
2025-05-21 15:48:31,369 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 15:48:31,373 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:48:31,375 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:48:31,376 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:48:31,377 - database.db_manager - WARNING - No user settings found
2025-05-21 15:48:41,436 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 15:48:41,437 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:48:41,439 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:48:41,439 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:48:41,440 - database.db_manager - WARNING - No user settings found
2025-05-21 15:48:51,501 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 15:48:51,501 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:48:51,503 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:48:51,504 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:48:51,505 - database.db_manager - WARNING - No user settings found
2025-05-21 15:49:01,590 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 15:49:01,592 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:49:01,593 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:49:01,594 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:49:01,595 - database.db_manager - WARNING - No user settings found
2025-05-21 15:49:11,709 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 15:49:11,710 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:49:11,711 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:49:11,711 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:49:11,712 - database.db_manager - WARNING - No user settings found
2025-05-21 15:49:21,769 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 15:49:21,771 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:49:21,772 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:49:21,773 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:49:21,774 - database.db_manager - WARNING - No user settings found
2025-05-21 15:49:31,845 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 15:49:31,846 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:49:31,848 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:49:31,849 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:49:31,854 - database.db_manager - WARNING - No user settings found
2025-05-21 15:49:41,933 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 15:49:41,935 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:49:41,936 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:49:41,937 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:49:41,938 - database.db_manager - WARNING - No user settings found
2025-05-21 15:49:52,015 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 15:49:52,018 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:49:52,018 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:49:52,018 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:49:52,020 - database.db_manager - WARNING - No user settings found
2025-05-21 15:50:02,088 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 15:50:02,089 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:50:02,091 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:50:02,091 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:50:02,092 - database.db_manager - WARNING - No user settings found
2025-05-21 15:50:12,147 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 15:50:12,147 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:50:12,149 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:50:12,150 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:50:12,152 - database.db_manager - WARNING - No user settings found
2025-05-21 15:50:22,252 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 15:50:22,254 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:50:22,256 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:50:22,257 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:50:22,258 - database.db_manager - WARNING - No user settings found
2025-05-21 15:50:32,339 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 15:50:32,340 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:50:32,342 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:50:32,342 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:50:32,344 - database.db_manager - WARNING - No user settings found
2025-05-21 15:50:42,475 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 15:50:42,476 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:50:42,478 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:50:42,479 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:50:42,481 - database.db_manager - WARNING - No user settings found
2025-05-21 15:50:45,328 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 15:50:45,331 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:50:45,331 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:50:45,332 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:50:45,333 - database.db_manager - WARNING - No user settings found
2025-05-21 15:50:45,341 - database.db_manager - WARNING - No data found for NIFTY 21-05-2025
2025-05-21 15:50:45,354 - processing.calculator - ERROR - No data available for processing
2025-05-21 15:50:55,407 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 15:50:55,409 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:50:55,410 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:50:55,410 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:50:55,412 - database.db_manager - WARNING - No user settings found
2025-05-21 15:51:05,532 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 15:51:05,534 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:51:05,535 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:51:05,536 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:51:05,537 - database.db_manager - WARNING - No user settings found
2025-05-21 15:51:15,603 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 15:51:15,603 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:51:15,604 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:51:15,605 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:51:15,606 - database.db_manager - WARNING - No user settings found
2025-05-21 15:51:25,666 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 15:51:25,667 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:51:25,670 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:51:25,670 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:51:25,672 - database.db_manager - WARNING - No user settings found
2025-05-21 15:51:35,727 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 15:51:35,728 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:51:35,730 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:51:35,731 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:51:35,732 - database.db_manager - WARNING - No user settings found
2025-05-21 15:51:45,804 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 15:51:45,806 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:51:45,807 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:51:45,807 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:51:45,808 - database.db_manager - WARNING - No user settings found
2025-05-21 15:51:55,909 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 15:51:55,911 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:51:55,912 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:51:55,913 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:51:55,914 - database.db_manager - WARNING - No user settings found
2025-05-21 15:52:05,990 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 15:52:05,992 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:52:05,994 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:52:05,995 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:52:05,996 - database.db_manager - WARNING - No user settings found
2025-05-21 15:52:07,386 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 15:52:07,388 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:52:07,389 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:52:07,390 - database.db_manager - INFO - Database initialized successfully
2025-05-21 15:52:07,392 - database.db_manager - WARNING - No user settings found
2025-05-21 16:02:30,311 - utils.helpers - INFO - Starting data collection for NIFTY with expiry 22-05-2025
2025-05-21 16:02:30,311 - utils.helpers - INFO - Starting dashboard...
2025-05-21 16:02:30,319 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:02:30,319 - utils.helpers - INFO - Outside trading hours. Waiting for next check...
2025-05-21 16:02:31,279 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 16:02:31,284 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:02:31,284 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:02:31,284 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:02:31,394 - database.db_manager - WARNING - No user settings found
2025-05-21 16:02:48,330 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 16:02:48,332 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:02:48,333 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:02:48,333 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:02:48,335 - database.db_manager - WARNING - No user settings found
2025-05-21 16:02:48,441 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 16:02:48,442 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:02:48,443 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:02:48,443 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:02:48,444 - database.db_manager - WARNING - No user settings found
2025-05-21 16:02:48,561 - data_collection.auth - INFO - Authentication successful, token expires in 43031 seconds
2025-05-21 16:02:48,562 - data_collection.collector - INFO - Collecting data for NIFTY with expiry 22-05-2025
2025-05-21 16:02:49,006 - data_collection.collector - INFO - Data saved to data/21-05-2025/NIFTY/NIFTY_22-05-2025_1602.xlsx
2025-05-21 16:02:49,017 - database.db_manager - INFO - Saved 95 records to database
2025-05-21 16:02:53,277 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 16:02:53,279 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:02:53,279 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:02:53,280 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:02:53,282 - database.db_manager - WARNING - No user settings found
2025-05-21 16:02:53,305 - processing.calculator - INFO - Calculating changes for requested 5min interval (actual: 33min, 2025-05-21 15:29:39)
2025-05-21 16:02:53,313 - processing.calculator - INFO - Calculating changes for requested 10min interval (actual: 33min, 2025-05-21 15:29:39)
2025-05-21 16:02:53,317 - processing.calculator - INFO - Calculating changes for requested 15min interval (actual: 33min, 2025-05-21 15:29:39)
2025-05-21 16:02:53,323 - processing.calculator - INFO - Calculating changes for requested 30min interval (actual: 33min, 2025-05-21 15:29:39)
2025-05-21 16:02:53,333 - __main__ - ERROR - Error updating dashboard: cannot convert float NaN to integer
Traceback (most recent call last):
  File "/Users/pranavjoshi/OptionChainProd/ui/dashboard.py", line 343, in update_dashboard_data
    result = calculator.process_latest_data(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/pranavjoshi/OptionChainProd/processing/calculator.py", line 200, in process_latest_data
    self.db.save_oi_changes(oi_changes)
  File "/Users/pranavjoshi/OptionChainProd/database/db_manager.py", line 207, in save_oi_changes
    int(row['pe_oi_change'])
ValueError: cannot convert float NaN to integer
2025-05-21 16:03:02,148 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 16:03:02,149 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:03:02,149 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:03:02,150 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:03:02,152 - database.db_manager - WARNING - No user settings found
2025-05-21 16:03:04,663 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 16:03:04,665 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:03:04,665 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:03:04,666 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:03:04,670 - database.db_manager - WARNING - No user settings found
2025-05-21 16:03:04,683 - processing.calculator - INFO - Calculating changes for requested 5min interval (actual: 33min, 2025-05-21 15:29:39)
2025-05-21 16:03:04,690 - processing.calculator - INFO - Calculating changes for requested 10min interval (actual: 33min, 2025-05-21 15:29:39)
2025-05-21 16:03:04,695 - processing.calculator - INFO - Calculating changes for requested 15min interval (actual: 33min, 2025-05-21 15:29:39)
2025-05-21 16:03:04,699 - processing.calculator - INFO - Calculating changes for requested 30min interval (actual: 33min, 2025-05-21 15:29:39)
2025-05-21 16:03:04,709 - __main__ - ERROR - Error updating dashboard: cannot convert float NaN to integer
Traceback (most recent call last):
  File "/Users/pranavjoshi/OptionChainProd/ui/dashboard.py", line 343, in update_dashboard_data
    result = calculator.process_latest_data(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/pranavjoshi/OptionChainProd/processing/calculator.py", line 200, in process_latest_data
    self.db.save_oi_changes(oi_changes)
  File "/Users/pranavjoshi/OptionChainProd/database/db_manager.py", line 207, in save_oi_changes
    int(row['pe_oi_change'])
ValueError: cannot convert float NaN to integer
2025-05-21 16:13:37,088 - utils.helpers - INFO - Starting data collection for NIFTY with expiry 22-05-2025
2025-05-21 16:13:37,088 - utils.helpers - INFO - Starting dashboard...
2025-05-21 16:13:37,095 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:13:37,096 - utils.helpers - INFO - Outside trading hours. Waiting for next check...
2025-05-21 16:13:38,026 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 16:15:11,204 - utils.helpers - INFO - Starting data collection for NIFTY with expiry 22-05-2025
2025-05-21 16:15:11,204 - utils.helpers - INFO - Starting dashboard...
2025-05-21 16:15:11,207 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:15:11,209 - utils.helpers - INFO - Outside trading hours. Waiting for next check...
2025-05-21 16:15:12,098 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 16:15:12,105 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:15:12,105 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:15:12,106 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:15:12,207 - database.db_manager - WARNING - No user settings found
2025-05-21 16:15:19,692 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 16:15:19,693 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:15:19,694 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:15:19,694 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:15:19,696 - database.db_manager - WARNING - No user settings found
2025-05-21 16:15:19,753 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 16:15:19,754 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:15:19,755 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:15:19,755 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:15:19,756 - database.db_manager - WARNING - No user settings found
2025-05-21 16:15:19,930 - data_collection.auth - INFO - Authentication successful, token expires in 42280 seconds
2025-05-21 16:15:19,931 - data_collection.collector - INFO - Collecting data for NIFTY with expiry 22-05-2025
2025-05-21 16:15:20,297 - data_collection.collector - INFO - Data saved to data/21-05-2025/NIFTY/NIFTY_22-05-2025_1615.xlsx
2025-05-21 16:15:20,308 - database.db_manager - INFO - Saved 95 records to database
2025-05-21 16:15:22,451 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 16:15:22,453 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:15:22,454 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:15:22,454 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:15:22,457 - database.db_manager - WARNING - No user settings found
2025-05-21 16:15:22,479 - processing.calculator - INFO - Calculating changes for requested 5min interval (actual: 13min, 2025-05-21 16:02:49)
2025-05-21 16:15:22,486 - processing.calculator - INFO - Calculating changes for requested 10min interval (actual: 13min, 2025-05-21 16:02:49)
2025-05-21 16:15:22,490 - processing.calculator - INFO - Calculating changes for requested 15min interval (actual: 13min, 2025-05-21 16:02:49)
2025-05-21 16:15:22,494 - processing.calculator - INFO - Calculating changes for requested 30min interval (actual: 46min, 2025-05-21 15:29:39)
2025-05-21 16:15:22,518 - database.db_manager - INFO - Saved 380 OI changes to database
2025-05-21 16:15:22,521 - database.db_manager - INFO - User settings saved to database
2025-05-21 16:15:22,525 - __main__ - ERROR - Error updating dashboard: Index contains duplicate entries, cannot reshape
Traceback (most recent call last):
  File "/Users/pranavjoshi/OptionChainProd/ui/dashboard.py", line 343, in update_dashboard_data
    result = calculator.process_latest_data(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/pranavjoshi/OptionChainProd/processing/calculator.py", line 247, in process_latest_data
    dashboard_data = self._prepare_dashboard_data(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/pranavjoshi/OptionChainProd/processing/calculator.py", line 276, in _prepare_dashboard_data
    ce_changes = oi_changes.pivot(
                 ^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/pandas/core/frame.py", line 9339, in pivot
    return pivot(self, index=index, columns=columns, values=values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/pandas/core/reshape/pivot.py", line 570, in pivot
    result = indexed.unstack(columns_listlike)  # type: ignore[arg-type]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/pandas/core/series.py", line 4615, in unstack
    return unstack(self, level, fill_value, sort)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/pandas/core/reshape/reshape.py", line 517, in unstack
    unstacker = _Unstacker(
                ^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/pandas/core/reshape/reshape.py", line 154, in __init__
    self._make_selectors()
  File "/opt/anaconda3/lib/python3.12/site-packages/pandas/core/reshape/reshape.py", line 210, in _make_selectors
    raise ValueError("Index contains duplicate entries, cannot reshape")
ValueError: Index contains duplicate entries, cannot reshape
2025-05-21 16:15:28,416 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 16:15:28,417 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:15:28,418 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:15:28,418 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:15:29,846 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 16:15:29,847 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:15:29,847 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:15:29,848 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:15:29,866 - processing.calculator - INFO - Calculating changes for requested 5min interval (actual: 13min, 2025-05-21 16:02:49)
2025-05-21 16:15:29,873 - processing.calculator - INFO - Calculating changes for requested 10min interval (actual: 13min, 2025-05-21 16:02:49)
2025-05-21 16:15:29,878 - processing.calculator - INFO - Calculating changes for requested 15min interval (actual: 13min, 2025-05-21 16:02:49)
2025-05-21 16:15:29,882 - processing.calculator - INFO - Calculating changes for requested 30min interval (actual: 46min, 2025-05-21 15:29:39)
2025-05-21 16:15:29,903 - database.db_manager - INFO - Saved 380 OI changes to database
2025-05-21 16:15:29,905 - database.db_manager - INFO - User settings saved to database
2025-05-21 16:15:29,906 - __main__ - ERROR - Error updating dashboard: Index contains duplicate entries, cannot reshape
Traceback (most recent call last):
  File "/Users/pranavjoshi/OptionChainProd/ui/dashboard.py", line 343, in update_dashboard_data
    result = calculator.process_latest_data(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/pranavjoshi/OptionChainProd/processing/calculator.py", line 247, in process_latest_data
    dashboard_data = self._prepare_dashboard_data(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/pranavjoshi/OptionChainProd/processing/calculator.py", line 276, in _prepare_dashboard_data
    ce_changes = oi_changes.pivot(
                 ^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/pandas/core/frame.py", line 9339, in pivot
    return pivot(self, index=index, columns=columns, values=values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/pandas/core/reshape/pivot.py", line 570, in pivot
    result = indexed.unstack(columns_listlike)  # type: ignore[arg-type]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/pandas/core/series.py", line 4615, in unstack
    return unstack(self, level, fill_value, sort)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/pandas/core/reshape/reshape.py", line 517, in unstack
    unstacker = _Unstacker(
                ^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/pandas/core/reshape/reshape.py", line 154, in __init__
    self._make_selectors()
  File "/opt/anaconda3/lib/python3.12/site-packages/pandas/core/reshape/reshape.py", line 210, in _make_selectors
    raise ValueError("Index contains duplicate entries, cannot reshape")
ValueError: Index contains duplicate entries, cannot reshape
2025-05-21 16:23:19,182 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 16:23:19,193 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:23:19,196 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:23:19,199 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:23:19,257 - processing.calculator - INFO - Calculating changes for requested 5min interval (actual: 13min, 2025-05-21 16:02:49)
2025-05-21 16:23:19,269 - processing.calculator - INFO - Calculating changes for requested 10min interval (actual: 13min, 2025-05-21 16:02:49)
2025-05-21 16:23:19,273 - processing.calculator - INFO - Calculating changes for requested 15min interval (actual: 13min, 2025-05-21 16:02:49)
2025-05-21 16:23:19,278 - processing.calculator - INFO - Calculating changes for requested 30min interval (actual: 46min, 2025-05-21 15:29:39)
2025-05-21 16:23:19,301 - database.db_manager - INFO - Saved 380 OI changes to database
2025-05-21 16:23:19,304 - database.db_manager - INFO - User settings saved to database
2025-05-21 16:23:19,309 - __main__ - ERROR - Error updating dashboard: Index contains duplicate entries, cannot reshape
Traceback (most recent call last):
  File "/Users/pranavjoshi/OptionChainProd/ui/dashboard.py", line 343, in update_dashboard_data
    result = calculator.process_latest_data(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/pranavjoshi/OptionChainProd/processing/calculator.py", line 247, in process_latest_data
    if col in dashboard_df.columns:
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/pranavjoshi/OptionChainProd/processing/calculator.py", line 276, in _prepare_dashboard_data
  File "/opt/anaconda3/lib/python3.12/site-packages/pandas/core/frame.py", line 9339, in pivot
    return pivot(self, index=index, columns=columns, values=values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/pandas/core/reshape/pivot.py", line 570, in pivot
    result = indexed.unstack(columns_listlike)  # type: ignore[arg-type]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/pandas/core/series.py", line 4615, in unstack
    return unstack(self, level, fill_value, sort)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/pandas/core/reshape/reshape.py", line 517, in unstack
    unstacker = _Unstacker(
                ^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/pandas/core/reshape/reshape.py", line 154, in __init__
    self._make_selectors()
  File "/opt/anaconda3/lib/python3.12/site-packages/pandas/core/reshape/reshape.py", line 210, in _make_selectors
    raise ValueError("Index contains duplicate entries, cannot reshape")
ValueError: Index contains duplicate entries, cannot reshape
2025-05-21 16:23:21,348 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 16:23:21,349 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:23:21,350 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:23:21,351 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:23:21,368 - processing.calculator - INFO - Calculating changes for requested 5min interval (actual: 13min, 2025-05-21 16:02:49)
2025-05-21 16:23:21,374 - processing.calculator - INFO - Calculating changes for requested 10min interval (actual: 13min, 2025-05-21 16:02:49)
2025-05-21 16:23:21,379 - processing.calculator - INFO - Calculating changes for requested 15min interval (actual: 13min, 2025-05-21 16:02:49)
2025-05-21 16:23:21,383 - processing.calculator - INFO - Calculating changes for requested 30min interval (actual: 46min, 2025-05-21 15:29:39)
2025-05-21 16:23:21,404 - database.db_manager - INFO - Saved 380 OI changes to database
2025-05-21 16:23:21,406 - database.db_manager - INFO - User settings saved to database
2025-05-21 16:23:21,407 - __main__ - ERROR - Error updating dashboard: Index contains duplicate entries, cannot reshape
Traceback (most recent call last):
  File "/Users/pranavjoshi/OptionChainProd/ui/dashboard.py", line 343, in update_dashboard_data
    result = calculator.process_latest_data(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/pranavjoshi/OptionChainProd/processing/calculator.py", line 247, in process_latest_data
    if col in dashboard_df.columns:
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/pranavjoshi/OptionChainProd/processing/calculator.py", line 276, in _prepare_dashboard_data
  File "/opt/anaconda3/lib/python3.12/site-packages/pandas/core/frame.py", line 9339, in pivot
    return pivot(self, index=index, columns=columns, values=values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/pandas/core/reshape/pivot.py", line 570, in pivot
    result = indexed.unstack(columns_listlike)  # type: ignore[arg-type]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/pandas/core/series.py", line 4615, in unstack
    return unstack(self, level, fill_value, sort)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/pandas/core/reshape/reshape.py", line 517, in unstack
    unstacker = _Unstacker(
                ^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/pandas/core/reshape/reshape.py", line 154, in __init__
    self._make_selectors()
  File "/opt/anaconda3/lib/python3.12/site-packages/pandas/core/reshape/reshape.py", line 210, in _make_selectors
    raise ValueError("Index contains duplicate entries, cannot reshape")
ValueError: Index contains duplicate entries, cannot reshape
2025-05-21 16:23:31,607 - utils.helpers - INFO - Starting data collection for NIFTY with expiry 22-05-2025
2025-05-21 16:23:31,607 - utils.helpers - INFO - Starting dashboard...
2025-05-21 16:23:31,609 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:23:31,609 - utils.helpers - INFO - Outside trading hours. Waiting for next check...
2025-05-21 16:23:32,540 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 16:23:32,547 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:23:32,547 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:23:32,548 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:23:39,193 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 16:23:39,194 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:23:39,195 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:23:39,196 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:23:39,376 - data_collection.auth - INFO - Authentication successful, token expires in 41780 seconds
2025-05-21 16:23:39,377 - data_collection.collector - INFO - Collecting data for NIFTY with expiry 22-05-2025
2025-05-21 16:23:39,737 - data_collection.collector - INFO - Data saved to data/21-05-2025/NIFTY/NIFTY_22-05-2025_1623.xlsx
2025-05-21 16:23:39,742 - database.db_manager - INFO - Saved 95 records to database
2025-05-21 16:23:43,084 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 16:23:43,086 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:23:43,087 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:23:43,087 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:23:44,260 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 16:23:44,261 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:23:44,261 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:23:44,261 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:23:44,271 - __main__ - ERROR - Error updating dashboard: 'OptionMetricsCalculator' object has no attribute 'process_latest_data'
Traceback (most recent call last):
  File "/Users/pranavjoshi/OptionChainProd/ui/dashboard.py", line 343, in update_dashboard_data
    result = calculator.process_latest_data(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'OptionMetricsCalculator' object has no attribute 'process_latest_data'
2025-05-21 16:26:12,799 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 16:26:12,804 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:26:12,806 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:26:12,807 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:26:12,817 - __main__ - ERROR - Error updating dashboard: 'OptionMetricsCalculator' object has no attribute 'process_latest_data'
Traceback (most recent call last):
  File "/Users/pranavjoshi/OptionChainProd/ui/dashboard.py", line 343, in update_dashboard_data
    result = calculator.process_latest_data(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'OptionMetricsCalculator' object has no attribute 'process_latest_data'
2025-05-21 16:26:14,465 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 16:26:14,467 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:26:14,467 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:26:14,468 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:26:14,478 - __main__ - ERROR - Error updating dashboard: 'OptionMetricsCalculator' object has no attribute 'process_latest_data'
Traceback (most recent call last):
  File "/Users/pranavjoshi/OptionChainProd/ui/dashboard.py", line 343, in update_dashboard_data
    result = calculator.process_latest_data(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'OptionMetricsCalculator' object has no attribute 'process_latest_data'
2025-05-21 16:26:15,074 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 16:26:15,075 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:26:15,076 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:26:15,076 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:26:15,086 - __main__ - ERROR - Error updating dashboard: 'OptionMetricsCalculator' object has no attribute 'process_latest_data'
Traceback (most recent call last):
  File "/Users/pranavjoshi/OptionChainProd/ui/dashboard.py", line 343, in update_dashboard_data
    result = calculator.process_latest_data(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'OptionMetricsCalculator' object has no attribute 'process_latest_data'
2025-05-21 16:26:15,224 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 16:26:15,225 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:26:15,226 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:26:15,226 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:26:15,235 - __main__ - ERROR - Error updating dashboard: 'OptionMetricsCalculator' object has no attribute 'process_latest_data'
Traceback (most recent call last):
  File "/Users/pranavjoshi/OptionChainProd/ui/dashboard.py", line 343, in update_dashboard_data
    result = calculator.process_latest_data(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'OptionMetricsCalculator' object has no attribute 'process_latest_data'
2025-05-21 16:26:15,364 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 16:26:15,366 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:26:15,367 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:26:15,368 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:26:15,377 - __main__ - ERROR - Error updating dashboard: 'OptionMetricsCalculator' object has no attribute 'process_latest_data'
Traceback (most recent call last):
  File "/Users/pranavjoshi/OptionChainProd/ui/dashboard.py", line 343, in update_dashboard_data
    result = calculator.process_latest_data(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'OptionMetricsCalculator' object has no attribute 'process_latest_data'
2025-05-21 16:26:15,497 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 16:26:15,498 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:26:15,498 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:26:15,499 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:26:15,509 - __main__ - ERROR - Error updating dashboard: 'OptionMetricsCalculator' object has no attribute 'process_latest_data'
Traceback (most recent call last):
  File "/Users/pranavjoshi/OptionChainProd/ui/dashboard.py", line 343, in update_dashboard_data
    result = calculator.process_latest_data(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'OptionMetricsCalculator' object has no attribute 'process_latest_data'
2025-05-21 16:26:15,597 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 16:26:15,598 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:26:15,598 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:26:15,598 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:26:15,603 - __main__ - ERROR - Error updating dashboard: 'OptionMetricsCalculator' object has no attribute 'process_latest_data'
Traceback (most recent call last):
  File "/Users/pranavjoshi/OptionChainProd/ui/dashboard.py", line 343, in update_dashboard_data
    result = calculator.process_latest_data(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'OptionMetricsCalculator' object has no attribute 'process_latest_data'
2025-05-21 16:26:26,576 - utils.helpers - INFO - Starting data collection for NIFTY with expiry 22-05-2025
2025-05-21 16:26:26,576 - utils.helpers - INFO - Starting dashboard...
2025-05-21 16:26:26,578 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:26:26,579 - utils.helpers - INFO - Outside trading hours. Waiting for next check...
2025-05-21 16:26:27,479 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 16:26:27,486 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:26:27,487 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:26:27,487 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:26:34,735 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 16:26:34,737 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:26:34,738 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:26:34,738 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:26:34,830 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 16:26:34,831 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:26:34,831 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:26:34,831 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:26:35,441 - data_collection.auth - INFO - Authentication successful, token expires in 41604 seconds
2025-05-21 16:26:35,442 - data_collection.collector - INFO - Collecting data for NIFTY with expiry 22-05-2025
2025-05-21 16:26:36,537 - data_collection.collector - INFO - Data saved to data/21-05-2025/NIFTY/NIFTY_22-05-2025_1626.xlsx
2025-05-21 16:26:36,543 - database.db_manager - INFO - Saved 95 records to database
2025-05-21 16:26:39,735 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 16:26:39,737 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:26:39,737 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:26:39,738 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:26:39,759 - processing.calculator - INFO - Calculating changes for requested 5min interval (actual: 3min, 2025-05-21 16:23:39)
2025-05-21 16:26:39,766 - processing.calculator - INFO - Calculating changes for requested 10min interval (actual: 11min, 2025-05-21 16:15:20)
2025-05-21 16:26:39,770 - processing.calculator - INFO - Calculating changes for requested 15min interval (actual: 11min, 2025-05-21 16:15:20)
2025-05-21 16:26:39,775 - processing.calculator - INFO - Calculating changes for requested 30min interval (actual: 24min, 2025-05-21 16:02:49)
2025-05-21 16:26:39,798 - database.db_manager - INFO - Saved 380 OI changes to database
2025-05-21 16:26:39,801 - database.db_manager - INFO - User settings saved to database
2025-05-21 16:26:49,881 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:26:49,883 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:26:49,884 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:26:49,933 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 16:26:52,466 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 16:26:52,468 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:26:52,469 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:26:52,470 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:26:52,489 - processing.calculator - INFO - Calculating changes for requested 5min interval (actual: 3min, 2025-05-21 16:23:39)
2025-05-21 16:26:52,494 - processing.calculator - INFO - Calculating changes for requested 10min interval (actual: 11min, 2025-05-21 16:15:20)
2025-05-21 16:26:52,498 - processing.calculator - INFO - Calculating changes for requested 15min interval (actual: 11min, 2025-05-21 16:15:20)
2025-05-21 16:26:52,502 - processing.calculator - INFO - Calculating changes for requested 30min interval (actual: 24min, 2025-05-21 16:02:49)
2025-05-21 16:26:52,523 - database.db_manager - INFO - Saved 380 OI changes to database
2025-05-21 16:26:52,525 - database.db_manager - INFO - User settings saved to database
2025-05-21 16:26:58,883 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 16:26:58,886 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:26:58,887 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:26:58,888 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:27:33,472 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 16:27:33,474 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:27:33,475 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:27:33,476 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:27:36,810 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 16:27:36,812 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:27:36,812 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:27:36,813 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:27:37,000 - data_collection.auth - INFO - Authentication successful, token expires in 41543 seconds
2025-05-21 16:27:37,001 - data_collection.collector - INFO - Collecting data for NIFTY with expiry 21-05-2025
2025-05-21 16:27:37,123 - data_collection.collector - ERROR - No data to save
2025-05-21 16:27:37,124 - database.db_manager - ERROR - No data to save to database
2025-05-21 16:27:40,479 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 16:27:40,480 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:27:40,480 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:27:40,481 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:27:43,581 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 16:27:43,582 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:27:43,585 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:27:43,586 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:27:51,063 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 16:27:51,064 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:27:51,066 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:27:51,066 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:27:51,763 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 16:27:51,764 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:27:51,764 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:27:51,765 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:27:51,785 - processing.calculator - INFO - Calculating changes for requested 5min interval (actual: 3min, 2025-05-21 16:23:39)
2025-05-21 16:27:51,790 - processing.calculator - INFO - Calculating changes for requested 10min interval (actual: 11min, 2025-05-21 16:15:20)
2025-05-21 16:27:51,794 - processing.calculator - INFO - Calculating changes for requested 15min interval (actual: 11min, 2025-05-21 16:15:20)
2025-05-21 16:27:51,799 - processing.calculator - INFO - Calculating changes for requested 30min interval (actual: 24min, 2025-05-21 16:02:49)
2025-05-21 16:27:51,820 - database.db_manager - INFO - Saved 380 OI changes to database
2025-05-21 16:27:51,822 - database.db_manager - INFO - User settings saved to database
2025-05-21 16:27:53,096 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 16:27:53,097 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:27:53,097 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:27:53,098 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:27:53,118 - processing.calculator - INFO - Calculating changes for requested 5min interval (actual: 3min, 2025-05-21 16:23:39)
2025-05-21 16:27:53,123 - processing.calculator - INFO - Calculating changes for requested 10min interval (actual: 11min, 2025-05-21 16:15:20)
2025-05-21 16:27:53,128 - processing.calculator - INFO - Calculating changes for requested 15min interval (actual: 11min, 2025-05-21 16:15:20)
2025-05-21 16:27:53,132 - processing.calculator - INFO - Calculating changes for requested 30min interval (actual: 24min, 2025-05-21 16:02:49)
2025-05-21 16:27:53,152 - database.db_manager - INFO - Saved 380 OI changes to database
2025-05-21 16:27:53,154 - database.db_manager - INFO - User settings saved to database
2025-05-21 16:27:53,445 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 16:27:53,446 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:27:53,446 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:27:53,447 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:27:53,466 - processing.calculator - INFO - Calculating changes for requested 5min interval (actual: 3min, 2025-05-21 16:23:39)
2025-05-21 16:27:53,472 - processing.calculator - INFO - Calculating changes for requested 10min interval (actual: 11min, 2025-05-21 16:15:20)
2025-05-21 16:27:53,477 - processing.calculator - INFO - Calculating changes for requested 15min interval (actual: 11min, 2025-05-21 16:15:20)
2025-05-21 16:27:53,481 - processing.calculator - INFO - Calculating changes for requested 30min interval (actual: 24min, 2025-05-21 16:02:49)
2025-05-21 16:27:53,503 - database.db_manager - INFO - Saved 380 OI changes to database
2025-05-21 16:27:53,505 - database.db_manager - INFO - User settings saved to database
2025-05-21 16:27:53,581 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 16:27:53,581 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:27:53,582 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:27:53,582 - database.db_manager - INFO - Database initialized successfully
2025-05-21 16:27:53,590 - processing.calculator - INFO - Calculating changes for requested 5min interval (actual: 3min, 2025-05-21 16:23:39)
2025-05-21 16:27:53,595 - processing.calculator - INFO - Calculating changes for requested 10min interval (actual: 11min, 2025-05-21 16:15:20)
2025-05-21 16:27:53,600 - processing.calculator - INFO - Calculating changes for requested 15min interval (actual: 11min, 2025-05-21 16:15:20)
2025-05-21 16:27:53,606 - processing.calculator - INFO - Calculating changes for requested 30min interval (actual: 24min, 2025-05-21 16:02:49)
2025-05-21 16:27:53,626 - database.db_manager - INFO - Saved 380 OI changes to database
2025-05-21 16:27:53,628 - database.db_manager - INFO - User settings saved to database
2025-05-21 20:31:07,554 - utils.helpers - INFO - Starting data collection for NIFTY with expiry 22-05-2025
2025-05-21 20:31:07,554 - utils.helpers - INFO - Starting dashboard...
2025-05-21 20:31:07,556 - database.db_manager - INFO - Database initialized successfully
2025-05-21 20:31:07,556 - utils.helpers - INFO - Outside trading hours. Waiting for next check...
2025-05-21 20:31:08,684 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 20:31:08,690 - database.db_manager - INFO - Database initialized successfully
2025-05-21 20:31:08,690 - database.db_manager - INFO - Database initialized successfully
2025-05-21 20:31:08,690 - database.db_manager - INFO - Database initialized successfully
2025-05-21 20:31:23,222 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 20:31:23,225 - database.db_manager - INFO - Database initialized successfully
2025-05-21 20:31:23,226 - database.db_manager - INFO - Database initialized successfully
2025-05-21 20:31:23,227 - database.db_manager - INFO - Database initialized successfully
2025-05-21 20:31:23,528 - data_collection.auth - INFO - Authentication successful, token expires in 26916 seconds
2025-05-21 20:31:23,530 - data_collection.collector - INFO - Collecting data for NIFTY with expiry 22-05-2025
2025-05-21 20:31:24,011 - data_collection.collector - INFO - Data saved to data/21-05-2025/NIFTY/NIFTY_22-05-2025_2031.xlsx
2025-05-21 20:31:24,019 - database.db_manager - INFO - Saved 95 records to database
2025-05-21 20:31:26,167 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 20:31:26,170 - database.db_manager - INFO - Database initialized successfully
2025-05-21 20:31:26,171 - database.db_manager - INFO - Database initialized successfully
2025-05-21 20:31:26,172 - database.db_manager - INFO - Database initialized successfully
2025-05-21 20:31:28,554 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-21 20:31:28,555 - database.db_manager - INFO - Database initialized successfully
2025-05-21 20:31:28,557 - database.db_manager - INFO - Database initialized successfully
2025-05-21 20:31:28,558 - database.db_manager - INFO - Database initialized successfully
2025-05-21 20:31:28,584 - processing.calculator - INFO - Calculating changes for requested 5min interval (actual: 245min, 2025-05-21 16:26:36)
2025-05-21 20:31:28,593 - processing.calculator - INFO - Calculating changes for requested 10min interval (actual: 245min, 2025-05-21 16:26:36)
2025-05-21 20:31:28,597 - processing.calculator - INFO - Calculating changes for requested 15min interval (actual: 245min, 2025-05-21 16:26:36)
2025-05-21 20:31:28,601 - processing.calculator - INFO - Calculating changes for requested 30min interval (actual: 245min, 2025-05-21 16:26:36)
2025-05-21 20:31:28,624 - database.db_manager - INFO - Saved 380 OI changes to database
2025-05-21 20:31:28,627 - database.db_manager - INFO - User settings saved to database
2025-05-22 08:44:19,431 - utils.helpers - INFO - Starting data collection for NIFTY with expiry 22-05-2025
2025-05-22 08:44:19,431 - utils.helpers - INFO - Starting dashboard...
2025-05-22 08:44:19,436 - database.db_manager - INFO - Database initialized successfully
2025-05-22 08:44:19,436 - utils.helpers - INFO - Outside trading hours. Waiting for next check...
2025-05-22 08:44:20,506 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-22 08:44:20,513 - database.db_manager - INFO - Database initialized successfully
2025-05-22 08:44:20,513 - database.db_manager - INFO - Database initialized successfully
2025-05-22 08:44:20,513 - database.db_manager - INFO - Database initialized successfully
2025-05-22 08:44:26,275 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-22 08:44:26,277 - database.db_manager - INFO - Database initialized successfully
2025-05-22 08:44:26,278 - database.db_manager - INFO - Database initialized successfully
2025-05-22 08:44:26,279 - database.db_manager - INFO - Database initialized successfully
2025-05-22 08:44:26,309 - processing.calculator - INFO - Calculating changes for requested 5min interval (actual: 245min, 2025-05-21 16:26:36)
2025-05-22 08:44:26,317 - processing.calculator - INFO - Calculating changes for requested 10min interval (actual: 245min, 2025-05-21 16:26:36)
2025-05-22 08:44:26,322 - processing.calculator - INFO - Calculating changes for requested 15min interval (actual: 245min, 2025-05-21 16:26:36)
2025-05-22 08:44:26,327 - processing.calculator - INFO - Calculating changes for requested 30min interval (actual: 245min, 2025-05-21 16:26:36)
2025-05-22 08:44:26,349 - database.db_manager - INFO - Saved 380 OI changes to database
2025-05-22 08:44:26,351 - database.db_manager - INFO - User settings saved to database
2025-05-22 08:44:35,280 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-22 08:44:35,282 - database.db_manager - INFO - Database initialized successfully
2025-05-22 08:44:35,283 - database.db_manager - INFO - Database initialized successfully
2025-05-22 08:44:35,284 - database.db_manager - INFO - Database initialized successfully
2025-05-22 08:44:35,513 - data_collection.auth - INFO - Authentication successful, token expires in 69324 seconds
2025-05-22 08:44:35,515 - data_collection.collector - INFO - Collecting data for NIFTY with expiry 22-05-2025
2025-05-22 08:44:36,130 - data_collection.collector - INFO - Data saved to data/22-05-2025/NIFTY/NIFTY_22-05-2025_0844.xlsx
2025-05-22 08:44:36,134 - database.db_manager - INFO - Saved 95 records to database
2025-05-22 08:44:39,662 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-22 08:44:39,664 - database.db_manager - INFO - Database initialized successfully
2025-05-22 08:44:39,665 - database.db_manager - INFO - Database initialized successfully
2025-05-22 08:44:39,666 - database.db_manager - INFO - Database initialized successfully
2025-05-22 08:44:39,686 - processing.calculator - INFO - Calculating changes for requested 5min interval (actual: 733min, 2025-05-21 20:31:24)
2025-05-22 08:44:39,692 - processing.calculator - INFO - Calculating changes for requested 10min interval (actual: 733min, 2025-05-21 20:31:24)
2025-05-22 08:44:39,696 - processing.calculator - INFO - Calculating changes for requested 15min interval (actual: 733min, 2025-05-21 20:31:24)
2025-05-22 08:44:39,701 - processing.calculator - INFO - Calculating changes for requested 30min interval (actual: 733min, 2025-05-21 20:31:24)
2025-05-22 08:44:39,722 - database.db_manager - INFO - Saved 380 OI changes to database
2025-05-22 08:44:39,724 - database.db_manager - INFO - User settings saved to database
2025-05-22 08:44:49,782 - database.db_manager - INFO - Database initialized successfully
2025-05-22 08:44:49,783 - database.db_manager - INFO - Database initialized successfully
2025-05-22 08:44:49,783 - database.db_manager - INFO - Database initialized successfully
2025-05-22 08:44:49,835 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-22 08:44:59,860 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-22 08:44:59,862 - database.db_manager - INFO - Database initialized successfully
2025-05-22 08:44:59,865 - database.db_manager - INFO - Database initialized successfully
2025-05-22 08:44:59,865 - database.db_manager - INFO - Database initialized successfully
2025-05-22 08:45:09,932 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-22 08:45:09,933 - database.db_manager - INFO - Database initialized successfully
2025-05-22 08:45:09,934 - database.db_manager - INFO - Database initialized successfully
2025-05-22 08:45:09,934 - database.db_manager - INFO - Database initialized successfully
2025-05-22 08:45:20,004 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-22 08:45:20,004 - database.db_manager - INFO - Database initialized successfully
2025-05-22 08:45:20,005 - database.db_manager - INFO - Database initialized successfully
2025-05-22 08:45:20,007 - database.db_manager - INFO - Database initialized successfully
2025-05-22 08:45:30,089 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-22 08:45:30,093 - database.db_manager - INFO - Database initialized successfully
2025-05-22 08:45:30,094 - database.db_manager - INFO - Database initialized successfully
2025-05-22 08:45:30,095 - database.db_manager - INFO - Database initialized successfully
2025-05-22 08:45:40,174 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-22 08:45:40,175 - database.db_manager - INFO - Database initialized successfully
2025-05-22 08:45:40,178 - database.db_manager - INFO - Database initialized successfully
2025-05-22 08:45:40,179 - database.db_manager - INFO - Database initialized successfully
2025-05-22 08:45:50,253 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-22 08:45:50,255 - database.db_manager - INFO - Database initialized successfully
2025-05-22 08:45:50,255 - database.db_manager - INFO - Database initialized successfully
2025-05-22 08:45:50,256 - database.db_manager - INFO - Database initialized successfully
2025-05-22 08:46:00,320 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-22 08:46:00,321 - database.db_manager - INFO - Database initialized successfully
2025-05-22 08:46:00,322 - database.db_manager - INFO - Database initialized successfully
2025-05-22 08:46:00,323 - database.db_manager - INFO - Database initialized successfully
2025-05-22 08:46:10,397 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-22 08:46:10,398 - database.db_manager - INFO - Database initialized successfully
2025-05-22 08:46:10,399 - database.db_manager - INFO - Database initialized successfully
2025-05-22 08:46:10,400 - database.db_manager - INFO - Database initialized successfully
2025-05-22 08:46:14,558 - asyncio - ERROR - Exception in callback AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518
handle: <Handle AppSession._on_scriptrunner_event.<locals>.<lambda>() at /opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py:518>
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/web/bootstrap.py", line 347, in run
    if asyncio.get_running_loop().is_running():
       ^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/asyncio/events.py", line 88, in _run
    self._context.run(self._callback, *self._args)
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 518, in <lambda>
    lambda: self._handle_scriptrunner_event_on_event_loop(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 612, in _handle_scriptrunner_event_on_event_loop
    msg = self._create_new_session_message(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/streamlit/runtime/app_session.py", line 756, in _create_new_session_message
    imsg.is_hello = self._script_data.is_hello
    ^^^^^^^^^^^^^
TypeError: '' has type str, but expected one of: int, bool
2025-05-22 08:46:14,560 - database.db_manager - INFO - Database initialized successfully
2025-05-22 08:46:14,561 - database.db_manager - INFO - Database initialized successfully
2025-05-22 08:46:14,561 - database.db_manager - INFO - Database initialized successfully
